{
   "name" : "lkp_sample2",
   "properties" : {
      "type": "MappingDataFlow",
      "typeProperties": {
      "sources" : [ {
         "dataset" : {
            "referenceName" : "Sequential_File_1",
            "type" : "DatasetReference"
         },
         "name" : "Sequential_File2",
         "script" : "source(output(\n\t\temp_id as String,\n\t\tname as String,\n\t\tdept_code as String\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> Sequential_File2"
      }, {
         "dataset" : {
            "referenceName" : "Sequential_File_lkp",
            "type" : "DatasetReference"
         },
         "name" : "Sequential_File_lkp",
         "script" : "source(output(\n\t\tcontact_no as String,\n\t\temail_address as String,\n\t\tid as String\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> Sequential_File_lkp"
      }, {
         "dataset" : {
            "referenceName" : "Sequential_File_0",
            "type" : "DatasetReference"
         },
         "name" : "Sequential_File1",
         "script" : "source(output(\n\t\temp_id as String,\n\t\tname as String,\n\t\tsalary as Integer,\n\t\tdept_code as String\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> Sequential_File1"
      }, {
         "dataset" : {
            "referenceName" : "Sequential_File_join",
            "type" : "DatasetReference"
         },
         "name" : "Sequential_FileJn",
         "script" : "source(output(\n\t\tsur_name as String,\n\t\tlocation as String,\n\t\tdesignation as String,\n\t\tid as String,\n\t\temp_dept_code as String\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> Sequential_FileJn"
      }, {
         "dataset" : {
            "referenceName" : "Sequential_File_un",
            "type" : "DatasetReference"
         },
         "name" : "Sequential_FileUn",
         "script" : "source(output(\n\t\temp_id as String,\n\t\tname as String,\n\t\tsalary as Integer,\n\t\tdept_code as String\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> Sequential_FileUn"
      } ],
      "sinks" : [ {
         "dataset" : {
            "referenceName" : "Data_Set_25",
            "type" : "DatasetReference"
         },
         "name" : "Data_Set1",
         "script" : "Rtr_EMPLOYEE@Case_Data_Set1 sink(saveMode:'overwrite' ) ~> Data_Set1"
      }, {
         "dataset" : {
            "referenceName" : "Data_Set_26",
            "type" : "DatasetReference"
         },
         "name" : "Data_Set2",
         "script" : "Lookup_6 sink(saveMode:'overwrite' ) ~> Data_Set2"
      }, {
         "dataset" : {
            "referenceName" : "Data_Set_tgt",
            "type" : "DatasetReference"
         },
         "name" : "Data_Set3",
         "script" : "Rtr_EMPLOYEE@Case_Data_Set3 sink(saveMode:'overwrite' ) ~> Data_Set3"
      } ],
      "transformations" : [ {
         "name" : "Agg_EMPLOYEE",
         "script" : "Exp_EMPLOYEE aggregate(\n\tgroupBy(u_name = u_name),\n\tgroupBy(dept_code = dept_code),\n\tgroupBy(name = name),\n\tgroupBy(emp_id = emp_id),\n\t\to_salary = sum(salary),\n\t\to_emp_id = count(emp_id)) ~> Agg_EMPLOYEE"
      }, {
         "name" : "Exp_EMPLOYEE",
         "script" : "funelInst derive(u_NAME = upper(name)) ~> Exp_EMPLOYEE"
      }, {
         "name" : "Rtr_EMPLOYEE",
         "script" : "Agg_EMPLOYEE split(o_salary == 20000,\no_salary >= 2000,\ndisjoint: false\n) ~> Rtr_EMPLOYEE@(Case_Data_Set1, Case_Data_Set3)"
      }, {
         "name" : "funelInst",
         "script" : "Sequential_File1, Sequential_FileUn union(byName: true) ~> funelInst"
      }, {
         "name" : "JNR_EMP",
         "script" : "Sequential_File2, Sequential_FileJn join(Sequential_File2@emp_id == Sequential_FileJn@id && \nSequential_File2@dept_code == Sequential_FileJn@emp_dept_code,\n joinType:'inner') ~> JNR_EMP"
      }, {
         "name" : "Lookup_6",
         "script" : "JNR_EMP, Sequential_File_lkp lookup(Sequential_File2@emp_id == Sequential_File_lkp@id) ~> Lookup_6"
      } ]
    }
   }
}
