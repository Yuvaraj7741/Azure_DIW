{
	"name": "dataflow8",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "edwgsttableratingdtlfactstgs1"
				}
			],
			"sinks": [
				{
					"name": "edwgsttableratingdtlfactt1"
				}
			],
			"transformations": [
				{
					"name": "xfmratingdtlpdbtriphdrs1"
				}
			],
			"script": "\nparameters{\n\tAPT_GRID_ENABLE as any (YES),\n\tAPT_GRID_COMPUTENODES as any (2),\n\tPS_APP_DIR as any ((Aspre-defined)),\n\tPS_DB_Name as any ((Aspre-defined)),\n\tPS_STREAM_INFO as any ((Aspre-defined)),\n\tPS_TD_Connector as any ((Aspre-defined))\n}\nsource(output(\n\t\tc_prop_cd as string,\n\t\ti_cms_dmid as decimal(10,0),\n\t\ti_dmid as decimal(10,0),\n\t\ti_rating_num as integer,\n\t\td_rating_date as date,\n\t\ti_rating_hyd as integer,\n\t\td_trans_date as date,\n\t\td_trans_time as integer,\n\t\ti_trans_hyd as integer,\n\t\tc_company as string,\n\t\tc_shift as string,\n\t\tc_pit_num as string,\n\t\tc_club as string,\n\t\tc_prop_game_cd as string,\n\t\tc_table_num as string,\n\t\tc_rate_type as string,\n\t\ti_countercheck_cnt as integer,\n\t\tf_countercheck as decimal(10,0),\n\t\tf_cash as decimal(10,0),\n\t\tf_avg_bet_1 as decimal(10,0),\n\t\tf_avg_bet_2 as decimal(10,0),\n\t\tf_avg_bet_3 as decimal(10,0),\n\t\tf_avg_bet_4 as decimal(10,0),\n\t\tf_avg_bet_5 as decimal(10,0),\n\t\tf_avg_bet_6 as decimal(10,0),\n\t\tf_hands_played as decimal(10,0),\n\t\tf_handle as decimal(10,0),\n\t\tf_buy_in as decimal(10,0),\n\t\tf_cash_out as decimal(10,0),\n\t\td_seq_rating_start_time as integer,\n\t\td_rating_start_time as integer,\n\t\td_rating_end_time as integer,\n\t\ti_minutes_played as integer,\n\t\tf_theo_win as decimal(10,0),\n\t\tf_actual_win as decimal(10,0),\n\t\tc_rated_by as string,\n\t\tc_entered_by as string,\n\t\tc_game_speed as string,\n\t\ti_rating_start_hr as integer,\n\t\ti_rating_end_hr as integer,\n\t\ti_pdb_trip_id as integer\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> edwgsttableratingdtlfactstgs1\nedwgsttableratingdtlfactstgs1 derive(i_pdb_trip_id = '( IF IsNotNull((edw_gst_table_rating_dtl_fact_stg_s1@i_pdb_trip_id)) THEN (edw_gst_table_rating_dtl_fact_stg_s1@i_pdb_trip_id) ELSE ((\"-1\")))',\n\t\tf_avg_bet_1_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_1) > 0 then 1 else 0',\n\t\tf_avg_bet_2_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_2) > 0 then 1 else 0',\n\t\tf_avg_bet_3_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_3) > 0 then 1 else 0',\n\t\tf_avg_bet_4_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_4) > 0 then 1 else 0',\n\t\tf_avg_bet_5_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_5) > 0 then 1 else 0',\n\t\tf_avg_bet_6_rating = 'if (edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_6) > 0 then 1 else 0',\n\t\tf_handle = '(edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_1) * (edw_gst_table_rating_dtl_fact_stg_s1@f_hands_played)',\n\t\tf_max_handle = '(edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_1 + edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_2 + edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_3 + edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_4 + edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_5 + edw_gst_table_rating_dtl_fact_stg_s1@f_avg_bet_6) * (edw_gst_table_rating_dtl_fact_stg_s1@f_hands_played)',\n\t\ti_rating_cnt = '1',\n\t\ti_num_distinct_hrs = 'if ((edw_gst_table_rating_dtl_fact_stg_s1@i_rating_end_hr) < (edw_gst_table_rating_dtl_fact_stg_s1@i_rating_start_hr)) then ((24 + (edw_gst_table_rating_dtl_fact_stg_s1@i_rating_end_hr)) - (edw_gst_table_rating_dtl_fact_stg_s1@i_rating_start_hr)) + 1 else ((edw_gst_table_rating_dtl_fact_stg_s1@i_rating_end_hr) - (edw_gst_table_rating_dtl_fact_stg_s1@i_rating_start_hr)) + 1') ~> xfmratingdtlpdbtriphdrs1\nxfmratingdtlpdbtriphdrs1 sink(mapColumn(\n\t\tc_prop_cd,\n\t\ti_cms_dmid,\n\t\ti_dmid,\n\t\ti_pdb_trip_id,\n\t\ti_rating_num,\n\t\td_rating_date,\n\t\ti_rating_hyd,\n\t\td_trans_date,\n\t\td_trans_time,\n\t\ti_trans_hyd,\n\t\tc_company,\n\t\tc_shift,\n\t\tc_pit_num,\n\t\tc_club,\n\t\tc_prop_game_cd,\n\t\tc_table_num,\n\t\tc_rate_type,\n\t\ti_countercheck_cnt,\n\t\tf_countercheck,\n\t\tf_cash,\n\t\tf_avg_bet_1,\n\t\tf_avg_bet_2,\n\t\tf_avg_bet_3,\n\t\tf_avg_bet_4,\n\t\tf_avg_bet_5,\n\t\tf_avg_bet_6,\n\t\tf_avg_bet_1_rating,\n\t\tf_avg_bet_2_rating,\n\t\tf_avg_bet_3_rating,\n\t\tf_avg_bet_4_rating,\n\t\tf_avg_bet_5_rating,\n\t\tf_avg_bet_6_rating,\n\t\tf_hands_played,\n\t\tf_handle,\n\t\tf_handle_cms = f_handle,\n\t\tf_buy_in,\n\t\tf_cash_out,\n\t\td_seq_rating_start_time,\n\t\td_rating_start_time,\n\t\td_rating_end_time,\n\t\ti_minutes_played,\n\t\tf_theo_win,\n\t\tf_actual_win,\n\t\tc_rated_by,\n\t\tc_entered_by,\n\t\tf_max_handle,\n\t\tc_game_speed,\n\t\ti_rating_start_hr,\n\t\ti_rating_end_hr,\n\t\ti_rating_cnt,\n\t\ti_num_distinct_hrs\n\t)) ~> edwgsttableratingdtlfactt1"
		}
	}
}