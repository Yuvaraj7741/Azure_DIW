{
   "name" : "s1_facets_bill_notice_dtl_ext",
   "properties" : {
      "type" : "MappingDataFlow",
      "typeProperties" : {
         "sources" : [ {
            "dataset" : {
               "referenceName" : "sq_QVBLFNBD",
               "type" : "DatasetReference"
            },
            "name" : "sq_QVBLFNBD"
         } ],
         "sinks" : [ {
            "dataset" : {
               "referenceName" : "DS_BILL_NOTICE_DTL",
               "type" : "DatasetReference"
            },
            "name" : "DS_BILL_NOTICE_DTL"
         } ],
         "script" : "\nparameters{\n\tEDAA_S1_Loads as string((As pre-defined)), \n\tEtlBatchId as string(null), \n\tSrcSysId as string(null), \n\tInvocation_Id as string(null), \n\tFileName as string(null), \n\tIntrdataset as string(null), \n}\nsource(output(\n\t\tSITE_ID as string,\n\t\tENTITY_ID as string,\n\t\tEG_COMMON_ID as string,\n\t\tEG_MODIFIER_ID as string,\n\t\tFILLER_3 as string,\n\t\tSBS_1_9_PK as string,\n\t\tSBS_SFX_PK as string,\n\t\tX5219_UNION_ID as string,\n\t\tX5220_LOCAL_ID as string,\n\t\tFILLER_6 as string,\n\t\tEG_PMT_DUE_DT_CC as string,\n\t\tEG_PMT_DUE_DT_YY as string,\n\t\tEG_PMT_DUE_DT_MM as string,\n\t\tEG_PMT_DUE_DT_DD as string,\n\t\tBIL_DTL_ITM_NBR as string,\n\t\tBIL_DTL_ADD_NBR as string,\n\t\tBILL_ENTITY_TYPE as string,\n\t\tEMPL_GROUP as string,\n\t\tSEQ_INV_1_10 as string,\n\t\tSEQ_INV_11 as string,\n\t\tMEDCD_INV_NUM as string,\n\t\tMBR_ALT_ID as string,\n\t\tUSER_FUNC_CODE as string,\n\t\tSBS_ID_1_9 as string,\n\t\tSBS_SEQ_N as string,\n\t\tBALANCE_AMT as string,\n\t\tSBS_LST_NAM as string,\n\t\tSBS_FST_NAM as string,\n\t\tSBS_MID_INIT as string,\n\t\tDEP_ID_1_9 as string,\n\t\tDEP_SEQ_N as string,\n\t\tNUMBER_LIVES as string,\n\t\tMBR_PMT_DUE_DT_CC as string,\n\t\tMBR_PMT_DUE_DT_YY as string,\n\t\tMBR_PMT_DUE_DT_MM as string,\n\t\tMBR_PMT_DUE_DT_DD as string,\n\t\tMBR_DUE_DT_PREM_AMT as string,\n\t\tBSR_RATE as string,\n\t\tBIL_ITM_DSC as string,\n\t\tBIL_BEN_SET_ID as string,\n\t\tBIL_CYC_CD as string,\n\t\tSPOUSE_DEP_IND as string,\n\t\tSTATEMENT_MEDIA_IND as string,\n\t\tTRANSACTION_CODE as string,\n\t\tFAMILY_MIX as string,\n\t\tRATE_TIER_CD as string,\n\t\tRATE_CVG_CD as string,\n\t\tMULT_APOP_IND as string,\n\t\tCAP_APPLID_IND as string,\n\t\tPAYROLL_CODE as string,\n\t\tRATE_FACTOR as string,\n\t\tBILL_FREQ as string,\n\t\tUNRECONCILLED_CD as string,\n\t\tLINE_OF_BUSINESS as string,\n\t\tRIDER_OPTION as string,\n\t\tTRAN_EFF_DT_CC as string,\n\t\tTRAN_EFF_DT_YY_9 as string,\n\t\tTRAN_EFF_DT_MM_9 as string,\n\t\tTRAN_EFF_DT_DD_9 as string,\n\t\tMEDCD_PMNT_AMNT as string,\n\t\tBILL_EG_COMMON_ID as string,\n\t\tBILL_EG_MODIFIER as string,\n\t\tBANK_CODE_ID as string,\n\t\tSTMT as string,\n\t\tMEDICAID_RATE_CD as string,\n\t\tNEW_MBR_ID as string,\n\t\tPRODUCT_ID as string,\n\t\tFUND_DESC_IND as string,\n\t\tFILLER_7 as string,\n\t\tMEDCD_REBILL_IND as string,\n\t\tBILL_TYPE as string,\n\t\tGROUP_TYPE as string,\n\t\tTYPE_OF_BUSINESS as string,\n\t\tPMT_SOURCE_CODE as string,\n\t\tGL_EXT_CC as string,\n\t\tGL_EXT_YY as string,\n\t\tGL_EXT_MM as string,\n\t\tGL_EXT_DD as string,\n\t\tARCH_DATE as string,\n\t\tFUNDING_TYPE as string,\n\t\tREQUEST_TYP as string,\n\t\tSUBSCRIBER_COUNT as string,\n\t\tPEND_WAIVER_IND as string,\n\t\tZERO_RATE_IND as string,\n\t\tACCOUNT_PERIOD_MMYY as string,\n\t\tRETRO_BILL_IND as string,\n\t\tADJ_CNTL_MM as string,\n\t\tADJ_CNTL_NO as string,\n\t\tCONTRACT_ORIGIN as string,\n\t\tAR_INCL as string,\n\t\tLOAD as string,\n\t\tPREM_CALC_INDIC as string,\n\t\tOFF_CYCLE_BILL_IND as string,\n\t\tFILLER_8 as string,\n\t\tADD_OP_ID as string,\n\t\tADD_PGM_ID as string,\n\t\tADD_DT_CC as string,\n\t\tADD_DT_YY as string,\n\t\tADD_DT_MM as string,\n\t\tADD_DT_DD as string,\n\t\tUPD_OP as string,\n\t\tUPD_PGM_ID as string,\n\t\tUPD_DT_CC as string,\n\t\tUPD_DT_YY as string,\n\t\tUPD_DT_MM as string,\n\t\tUPD_DT_DD as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false) ~> sq_QVBLFNBD\nXfm_QVBLFNBD sink(mapColumn(\n\t\tSITE_ID,\n\t\tENTITY_ID,\n\t\tEG_COMMON_ID,\n\t\tEG_MODIFIER_ID,\n\t\tSBS_ID_PK,\n\t\tSBS_SFX_PK,\n\t\tX5219_UNION_ID,\n\t\tX5220_LOCAL_ID,\n\t\tEG_PMT_DUE_DT,\n\t\tBIL_DTL_ITM_NBR,\n\t\tBIL_DTL_ADD_NBR,\n\t\tBILL_ENTITY_TYPE,\n\t\tEMPL_GROUP,\n\t\tSEQ_INV_1_10,\n\t\tSEQ_INV_11,\n\t\tMEDCD_INV_NUM,\n\t\tMBR_ALT_ID,\n\t\tUSER_FUNC_CODE,\n\t\tSBS_ID_1_9,\n\t\tSBS_SEQ_N,\n\t\tBALANCE_AMT,\n\t\tSBS_LST_NAM,\n\t\tSBS_FST_NAM,\n\t\tSBS_MID_INIT,\n\t\tDEP_ID_1_9,\n\t\tDEP_SEQ_N,\n\t\tNUMBER_LIVES,\n\t\tMBR_PMT_DUE_DT_CC,\n\t\tMBR_DUE_DT_PREM_AMT,\n\t\tBSR_RATE,\n\t\tBIL_ITM_DSC,\n\t\tBIL_BEN_SET_ID,\n\t\tBIL_CYC_CD,\n\t\tSPOUSE_DEP_IND,\n\t\tSTATEMENT_MEDIA_IND,\n\t\tTRANSACTION_CODE,\n\t\tFAMILY_MIX,\n\t\tRATE_TIER_CD,\n\t\tRATE_CVG_CD,\n\t\tMULT_APOP_IND,\n\t\tCAP_APPLID_IND,\n\t\tPAYROLL_CODE,\n\t\tRATE_FACTOR,\n\t\tBILL_FREQ,\n\t\tUNRECONCILLED_CD,\n\t\tLINE_OF_BUSINESS,\n\t\tRIDER_OPTION,\n\t\tTRAN_EFF_DT,\n\t\tMEDCD_PMNT_AMNT,\n\t\tBILL_EG_COMMON_ID,\n\t\tBILL_EG_MODIFIER,\n\t\tBANK_CODE_ID,\n\t\tSTMT,\n\t\tMEDICAID_RATE_CD,\n\t\tNEW_MBR_ID,\n\t\tPRODUCT_ID,\n\t\tFUND_DESC_IND,\n\t\tMEDCD_REBILL_IND,\n\t\tBILL_TYPE,\n\t\tGROUP_TYPE,\n\t\tTYPE_OF_BUSINESS,\n\t\tPMT_SOURCE_CODE,\n\t\tGL_EXTRACT_DATE,\n\t\tARCH_DATE,\n\t\tFUNDING_TYPE,\n\t\tREQUEST_TYP,\n\t\tSUBSCRIBER_COUNT,\n\t\tPEND_WAIVER_IND,\n\t\tZERO_RATE_IND,\n\t\tACCOUNT_PERIOD_MMYY,\n\t\tRETRO_BILL_IND,\n\t\tADJ_CNTL_MM,\n\t\tADJ_CNTL_NO,\n\t\tCONTRACT_ORIGIN,\n\t\tAR_INCL,\n\t\tLOAD,\n\t\tPREM_CALC_INDIC,\n\t\tOFF_CYCLE_BILL_IND,\n\t\tADD_OP_ID,\n\t\tADD_PGM_ID,\n\t\tADD_DATE,\n\t\tUPD_OP_ID,\n\t\tUPD_PGM_ID,\n\t\tUPD_DATE,\n\t\tSRC_SYS_ID,\n\t\tBATCH_ID,\n\t\tETL_DATE_CREATED,\n\t\tETL_DATE_UPDATED\n\t)) ~> DS_BILL_NOTICE_DTL\nsq_QVBLFNBD derive(SITE_ID = trim(SITE_ID),\n\t\tENTITY_ID = trim(ENTITY_ID),\n\t\tEG_COMMON_ID = trim(EG_COMMON_ID),\n\t\tEG_MODIFIER_ID = trim(EG_MODIFIER_ID),\n\t\tSBS_ID_PK = trim(SBS_1_9_PK),\n\t\tSBS_SFX_PK = trim(SBS_SFX_PK),\n\t\tX5219_UNION_ID = trim(X5219_UNION_ID),\n\t\tX5220_LOCAL_ID = trim(X5220_LOCAL_ID),\n\t\tEG_PMT_DUE_DT = 'trim(sq_QVBLFNBD@EG_PMT_DUE_DT_CC)[1, 2] : trim(sq_QVBLFNBD@EG_PMT_DUE_DT_YY)[1, 2] : trim(sq_QVBLFNBD@EG_PMT_DUE_DT_MM)[1, 2] : trim(sq_QVBLFNBD@EG_PMT_DUE_DT_DD)[1, 2]',\n\t\tBIL_DTL_ITM_NBR = trim(BIL_DTL_ITM_NBR),\n\t\tBIL_DTL_ADD_NBR = trim(BIL_DTL_ADD_NBR),\n\t\tBILL_ENTITY_TYPE = trim(BILL_ENTITY_TYPE),\n\t\tEMPL_GROUP = trim(EMPL_GROUP),\n\t\tSEQ_INV_1_10 = trim(SEQ_INV_1_10),\n\t\tSEQ_INV_11 = trim(SEQ_INV_11),\n\t\tMBR_ALT_ID = trim(MBR_ALT_ID),\n\t\tUSER_FUNC_CODE = trim(USER_FUNC_CODE),\n\t\tSBS_ID_1_9 = trim(SBS_ID_1_9),\n\t\tSBS_SEQ_N = trim(SBS_SEQ_N),\n\t\tBALANCE_AMT = trim(BALANCE_AMT),\n\t\tSBS_LST_NAM = trim(SBS_LST_NAM),\n\t\tSBS_FST_NAM = trim(SBS_FST_NAM),\n\t\tSBS_MID_INIT = trim(SBS_MID_INIT),\n\t\tDEP_ID_1_9 = trim(DEP_ID_1_9),\n\t\tDEP_SEQ_N = trim(DEP_SEQ_N),\n\t\tNUMBER_LIVES = trim(NUMBER_LIVES),\n\t\tMBR_PMT_DUE_DT_CC = 'trim(sq_QVBLFNBD@MBR_PMT_DUE_DT_CC)[1, 2] : trim(sq_QVBLFNBD@MBR_PMT_DUE_DT_YY)[1, 2] : trim(sq_QVBLFNBD@MBR_PMT_DUE_DT_MM)[1, 2] : trim(sq_QVBLFNBD@MBR_PMT_DUE_DT_DD)[1, 2]',\n\t\tMBR_DUE_DT_PREM_AMT = 'if sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[1, 1] = \"+\" then Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[1, 1] = \"-\" and Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[2, 11], \"0\", \"L\") > \"@00\" then \"-\" : Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[1, 1] = \"-\" and Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[2, 11], \"0\", \"L\") = \"@00\" then Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT[2, 11], \"0\", \"L\") else Trim(sq_QVBLFNBD@MBR_DUE_DT_PREM_AMT, \"0\", \"L\")',\n\t\tBSR_RATE = 'if sq_QVBLFNBD@BSR_RATE[1, 1] = \"+\" then Trim(sq_QVBLFNBD@BSR_RATE[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@BSR_RATE[1, 1] = \"-\" and Trim(sq_QVBLFNBD@BSR_RATE[2, 11], \"0\", \"L\") > \"@00\" then \"-\" : Trim(sq_QVBLFNBD@BSR_RATE[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@BSR_RATE[1, 1] = \"-\" and Trim(sq_QVBLFNBD@BSR_RATE[2, 11], \"0\", \"L\") = \"@00\" then Trim(sq_QVBLFNBD@BSR_RATE[2, 11], \"0\", \"L\") else Trim(sq_QVBLFNBD@BSR_RATE, \"0\", \"L\")',\n\t\tBIL_ITM_DSC = trim(BIL_ITM_DSC),\n\t\tBIL_BEN_SET_ID = trim(BIL_BEN_SET_ID),\n\t\tBIL_CYC_CD = trim(BIL_CYC_CD),\n\t\tSPOUSE_DEP_IND = trim(SPOUSE_DEP_IND),\n\t\tSTATEMENT_MEDIA_IND = trim(STATEMENT_MEDIA_IND),\n\t\tTRANSACTION_CODE = trim(TRANSACTION_CODE),\n\t\tFAMILY_MIX = trim(FAMILY_MIX),\n\t\tRATE_TIER_CD = trim(RATE_TIER_CD),\n\t\tRATE_CVG_CD = trim(RATE_CVG_CD),\n\t\tMULT_APOP_IND = trim(MULT_APOP_IND),\n\t\tCAP_APPLID_IND = trim(CAP_APPLID_IND),\n\t\tPAYROLL_CODE = trim(PAYROLL_CODE),\n\t\tRATE_FACTOR = 'if sq_QVBLFNBD@RATE_FACTOR[1, 1] = \"+\" then Trim(sq_QVBLFNBD@RATE_FACTOR[2, 9], \"0\", \"L\") else  if sq_QVBLFNBD@RATE_FACTOR[1, 1] = \"-\" and Trim(sq_QVBLFNBD@RATE_FACTOR[2, 9], \"0\", \"L\") > \"@0000\" then \"-\" : Trim(sq_QVBLFNBD@RATE_FACTOR[2, 9], \"0\", \"L\") else  if sq_QVBLFNBD@RATE_FACTOR[1, 1] = \"-\" and Trim(sq_QVBLFNBD@RATE_FACTOR[2, 9], \"0\", \"L\") = \"@0000\" then Trim(sq_QVBLFNBD@RATE_FACTOR[2, 9], \"0\", \"L\") else Trim(sq_QVBLFNBD@RATE_FACTOR[1, 9], \"0\", \"L\")',\n\t\tBILL_FREQ = trim(BILL_FREQ),\n\t\tUNRECONCILLED_CD = trim(UNRECONCILLED_CD),\n\t\tLINE_OF_BUSINESS = trim(LINE_OF_BUSINESS),\n\t\tRIDER_OPTION = trim(RIDER_OPTION),\n\t\tTRAN_EFF_DT = 'trim(sq_QVBLFNBD@TRAN_EFF_DT_CC)[1, 2] : trim(sq_QVBLFNBD@TRAN_EFF_DT_YY_9)[1, 2] : trim(sq_QVBLFNBD@TRAN_EFF_DT_MM_9)[1, 2] : trim(sq_QVBLFNBD@TRAN_EFF_DT_DD_9)[1, 2]',\n\t\tMEDCD_PMNT_AMNT = 'if sq_QVBLFNBD@MEDCD_PMNT_AMNT[1, 1] = \"+\" then Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@MEDCD_PMNT_AMNT[1, 1] = \"-\" and Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT[2, 11], \"0\", \"L\") > \"@00\" then \"-\" : Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT[2, 11], \"0\", \"L\") else  if sq_QVBLFNBD@MEDCD_PMNT_AMNT[1, 1] = \"-\" and Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT[2, 11], \"0\", \"L\") = \"@00\" then Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT[2, 11], \"0\", \"L\") else Trim(sq_QVBLFNBD@MEDCD_PMNT_AMNT, \"0\", \"L\")',\n\t\tBILL_EG_COMMON_ID = trim(BILL_EG_COMMON_ID),\n\t\tBILL_EG_MODIFIER = trim(BILL_EG_MODIFIER),\n\t\tBANK_CODE_ID = trim(BANK_CODE_ID),\n\t\tSTMT = trim(STMT),\n\t\tMEDICAID_RATE_CD = trim(MEDICAID_RATE_CD),\n\t\tNEW_MBR_ID = trim(NEW_MBR_ID),\n\t\tPRODUCT_ID = trim(PRODUCT_ID),\n\t\tFUND_DESC_IND = trim(FUND_DESC_IND),\n\t\tMEDCD_REBILL_IND = trim(MEDCD_REBILL_IND),\n\t\tBILL_TYPE = trim(BILL_TYPE),\n\t\tGROUP_TYPE = trim(GROUP_TYPE),\n\t\tTYPE_OF_BUSINESS = trim(TYPE_OF_BUSINESS),\n\t\tPMT_SOURCE_CODE = trim(PMT_SOURCE_CODE),\n\t\tGL_EXTRACT_DATE = 'trim(sq_QVBLFNBD@GL_EXT_CC)[1, 2] : trim(sq_QVBLFNBD@GL_EXT_YY)[1, 2] : trim(sq_QVBLFNBD@GL_EXT_MM)[1, 2] : trim(sq_QVBLFNBD@GL_EXT_DD)[1, 2]',\n\t\tARCH_DATE = trim(ARCH_DATE),\n\t\tFUNDING_TYPE = trim(FUNDING_TYPE),\n\t\tREQUEST_TYP = trim(REQUEST_TYP),\n\t\tSUBSCRIBER_COUNT = trim(SUBSCRIBER_COUNT),\n\t\tPEND_WAIVER_IND = trim(PEND_WAIVER_IND),\n\t\tZERO_RATE_IND = trim(ZERO_RATE_IND),\n\t\tACCOUNT_PERIOD_MMYY = 'Str(\"0\", 4 - len(trim(sq_QVBLFNBD@ACCOUNT_PERIOD_MMYY))) : trim(sq_QVBLFNBD@ACCOUNT_PERIOD_MMYY)',\n\t\tRETRO_BILL_IND = trim(RETRO_BILL_IND),\n\t\tADJ_CNTL_MM = trim(ADJ_CNTL_MM),\n\t\tADJ_CNTL_NO = trim(ADJ_CNTL_NO),\n\t\tCONTRACT_ORIGIN = trim(CONTRACT_ORIGIN),\n\t\tAR_INCL = trim(AR_INCL),\n\t\tLOAD = trim(LOAD),\n\t\tPREM_CALC_INDIC = trim(PREM_CALC_INDIC),\n\t\tOFF_CYCLE_BILL_IND = trim(OFF_CYCLE_BILL_IND),\n\t\tADD_OP_ID = trim(ADD_OP_ID),\n\t\tADD_PGM_ID = trim(ADD_PGM_ID),\n\t\tADD_DATE = 'trim(sq_QVBLFNBD@ADD_DT_CC)[1, 2] : trim(sq_QVBLFNBD@ADD_DT_YY)[1, 2] : trim(sq_QVBLFNBD@ADD_DT_MM)[1, 2] : trim(sq_QVBLFNBD@ADD_DT_DD)[1, 2]',\n\t\tUPD_OP_ID = trim(UPD_OP),\n\t\tUPD_PGM_ID = trim(UPD_PGM_ID),\n\t\tUPD_DATE = 'trim(sq_QVBLFNBD@UPD_DT_CC)[1, 2] : trim(sq_QVBLFNBD@UPD_DT_YY)[1, 2] : trim(sq_QVBLFNBD@UPD_DT_MM)[1, 2] : trim(sq_QVBLFNBD@UPD_DT_DD)[1, 2]',\n\t\tSRC_SYS_ID = 'SrcSysId',\n\t\tBATCH_ID = 'EtlBatchId',\n\t\tETL_DATE_CREATED = 'DSJobStartTimestamp',\n\t\tETL_DATE_UPDATED = 'DSJobStartTimestamp') ~> Xfm_QVBLFNBD"
      }
   }
}